<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apex Token</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
background:#0b0f19;
color:white;
font-family:Arial;
margin:0;
}

header{
display:flex;
justify-content:space-between;
align-items:center;
padding:20px;
background:#111827;
}

button{
padding:10px 20px;
border:none;
border-radius:8px;
background:#2563eb;
color:white;
cursor:pointer;
font-weight:bold;
}

.container{
padding:20px;
}

.stats{
display:flex;
flex-wrap:wrap;
gap:20px;
}

.card{
flex:1;
min-width:200px;
background:#1f2937;
padding:20px;
border-radius:12px;
}

.staking{
margin-top:30px;
background:#1f2937;
padding:20px;
border-radius:12px;
}

input{
padding:10px;
width:200px;
border-radius:6px;
border:none;
margin-right:10px;
}
</style>
</head>
<body>

<header>
<h2>âš¡ APEX TOKEN</h2>
<button onclick="connectWallet()">Connect Wallet</button>
</header>

<div class="container">

<div class="stats">
<div class="card">
<h4>PreÃ§o</h4>
<p id="price">$0.0000</p>
</div>

<div class="card">
<h4>Market Cap</h4>
<p id="marketcap">$0</p>
</div>

<div class="card">
<h4>Total Supply</h4>
<p id="supply">0</p>
</div>

<div class="card">
<h4>Seu Saldo</h4>
<p id="balance">0</p>
</div>
</div>

<canvas id="chart" height="100"></canvas>

<div class="staking">
<h3>ðŸ”¥ Staking</h3>
<p>APR: 20%</p>

<input type="number" id="stakeAmount" placeholder="Quantidade APEX">
<button onclick="stake()">Stake</button>
<button onclick="unstake()">Unstake</button>

<p>Staked: <span id="staked">0</span></p>
<p>Recompensa: <span id="reward">0</span></p>
</div>

</div>

<script>

const tokenAddress = "SEU_CONTRATO_TOKEN";
const stakingAddress = "SEU_CONTRATO_STAKING";

const tokenABI = [
"function balanceOf(address owner) view returns (uint256)",
"function decimals() view returns (uint8)",
"function totalSupply() view returns (uint256)",
"function approve(address spender, uint256 amount) returns (bool)"
];

const stakingABI = [
"function stake(uint256 amount)",
"function withdraw(uint256 amount)",
"function earned(address account) view returns(uint256)",
"function balanceOf(address account) view returns(uint256)"
];

let provider;
let signer;
let userAddress;

async function connectWallet(){

if(!window.ethereum){
alert("Use MetaMask Browser or WalletConnect");
return;
}

provider = new ethers.providers.Web3Provider(window.ethereum);
await provider.send("eth_requestAccounts", []);
signer = provider.getSigner();
userAddress = await signer.getAddress();

loadData();
}

async function loadData(){

const token = new ethers.Contract(tokenAddress, tokenABI, provider);
const staking = new ethers.Contract(stakingAddress, stakingABI, provider);

let decimals = await token.decimals();

let balance = await token.balanceOf(userAddress);
balance = balance / Math.pow(10, decimals);
document.getElementById("balance").innerText = balance.toFixed(2);

let supply = await token.totalSupply();
supply = supply / Math.pow(10, decimals);
document.getElementById("supply").innerText = supply.toFixed(0);

let staked = await staking.balanceOf(userAddress);
staked = staked / Math.pow(10, decimals);
document.getElementById("staked").innerText = staked.toFixed(2);

let reward = await staking.earned(userAddress);
reward = reward / Math.pow(10, decimals);
document.getElementById("reward").innerText = reward.toFixed(2);

createChart();
}

async function stake(){

const token = new ethers.Contract(tokenAddress, tokenABI, signer);
const staking = new ethers.Contract(stakingAddress, stakingABI, signer);

let amount = document.getElementById("stakeAmount").value;
let decimals = await token.decimals();

let parsed = ethers.utils.parseUnits(amount, decimals);

await token.approve(stakingAddress, parsed);
await staking.stake(parsed);

alert("Staked successfully!");
}

async function unstake(){

const staking = new ethers.Contract(stakingAddress, stakingABI, signer);

let amount = document.getElementById("stakeAmount").value;
let parsed = ethers.utils.parseUnits(amount, 18);

await staking.withdraw(parsed);

alert("Unstaked!");
}

function createChart(){

new Chart(document.getElementById("chart"),{
type:"line",
data:{
labels:["Day1","Day2","Day3","Day4","Day5"],
datasets:[{
label:"PreÃ§o",
data:[0.001,0.002,0.0018,0.0025,0.003],
borderColor:"#2563eb"
}]
}
});

}

</script>

</body>
</html>
